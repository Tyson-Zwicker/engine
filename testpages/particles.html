<html>

<head>
    <script src=".././maths.js"></script>
    <script src=".././main.js"></script>
    <script src=".././button.js"></script>
    <script src=".././tattle.js"></script>
</head>

<body onload="buildPage(33)" style="border:none">
    <script>
        const Particle = function (position, velocity, life, r, g, b) {
            this.position = position;
            this.velocity = velocity;
            this.lifespan = life;
            this.red = parseInt(red, 16);
            this.green = parseInt(red / 16);
            this.blue = parseInt(blue / 16);
            this.redFade = this.red / life;
            this.blueFade = this.blue / life
            this.greenFade = this.green / life;
            this.manager = null;
        }
        Particle.prototype.move = function (delta) {
            this.position.x += this.velocity.x / delta;
            this.position.y += this.velocity.y / delta;
            this.red -= this.redFade / delta;
            this.blue -= this.blueFade / delta;
            this.green -= this.greenFade / delta;
            if (this.red === 0) this.red = 0;
            if (this.green === 0) this.green = 0;
            if (this.blue === 0) this.blue = 0;
            this.lifespan--;
        }
        Particle.prototype.draw= function (camera){
            let x = this.x - camera.x;
            let y = this.y - camera.y;
            let color = `#${this.red.toString(16)}${this.green.toString(16)}${this.blue.toString(16)}`;
            drawPixel (x,y,color);
        }
        const ParticalManager = function ParticleManager() {
            this.particles = [];
        }
        //particle : position, velocity, life, r, g, b
        ParticleManager.prototype.addBurst = function (x,y,number, r, g, b, minlife, maxlife, a0, a1, magnitude) {
            for (let i = 0; i < number; i++) {
                let velocity = new Vector (rnd (a0,a1),rnd (magnitude/2));
                let particle = new Particle (position,velocity,rnd (minlife, maxlife),r,g,b);
            }
        }
        ParticleManager.prototype.process = function () {
            let alive = [];
            this.particles.forEach(particle => {
                particle.move();
                if (particle.lifespan > 0) {
                    particle.draw();
                    particle.move();
                    alive.push (particle);
                }
            });
            this.particles = alive;
        }
    </script>
</body>
</html>